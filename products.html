<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - HairIA</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/products.css">
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <img src="images/logo.jpg" alt="HairIA Logo" class="logo">
        </div>
        <nav class="nav">
            <a href="index.html#diagnostico" class="nav-link">Inicio</a>
            <a href="products.html" class="nav-link">Productos</a>
            <a href="index.html#nosotros" class="nav-link">Nosotros</a>
        </nav>
        <div class="user-actions">
            <button id="loginBtn" class="login-btn">Iniciar Sesi√≥n</button>
            <div class="cart-icon" id="cartIcon">
                üõí <span class="cart-count">0</span>
            </div>
        </div>
    </header>

    <!-- Search Bar -->
    <div class="search-container">
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Buscar productos...">
            <button id="searchButton">üîç</button>
        </div>
    </div>

    <!-- Filtros por Categor√≠a -->
    <div class="filters-container">
        <div class="container">
            <div class="category-filters" id="categoryFilters">
                <button class="filter-btn active" data-category="all">Todos</button>
                <!-- Las categor√≠as se cargan din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Productos -->
    <section class="products-section">
        <div class="container">
            <h2 class="section-title" id="productsTitle">Todos los Productos</h2>
            <div class="products-grid" id="productsGrid">
                <!-- Productos se cargan din√°micamente -->
            </div>
        </div>
    </section>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Tu Carrito de Compras</h3>
            <button id="closeCart" class="close-cart">√ó</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Items del carrito se cargan din√°micamente -->
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span>$<span id="cartTotal">0.00</span></span>
            </div>
            <button class="checkout-btn">Proceder al Pago</button>
        </div>
    </div>
    <div class="cart-overlay" id="cartOverlay"></div>

    <!-- Modal de Detalles de Producto -->
    <div class="product-modal" id="productModal">
        <div class="modal-overlay" id="modalOverlay"></div>
        <div class="modal-content">
            <button class="modal-close" id="modalClose">√ó</button>
            
            <div class="product-modal-content">
                <!-- Imagen del producto -->
                <div class="modal-product-image">
                    <img id="modalProductImage" src="" alt="">
                    <div class="modal-image-placeholder" id="modalImagePlaceholder">
                        <span class="placeholder-emoji">üõçÔ∏è</span>
                        <span>Imagen no disponible</span>
                    </div>
                </div>
                
                <!-- Informaci√≥n del producto -->
                <div class="modal-product-info">
                    <div class="modal-header">
                        <h2 id="modalProductName">Nombre del Producto</h2>
                        <div class="modal-price" id="modalProductPrice">$0.00</div>
                    </div>
                    
                    <div class="modal-category" id="modalProductCategory">Categor√≠a</div>
                    
                    <div class="modal-section">
                        <h3>üìã Descripci√≥n</h3>
                        <p id="modalProductDescription">Descripci√≥n del producto...</p>
                    </div>
                    
                    <div class="modal-section" id="modalIngredientsSection">
                        <h3>üß™ Ingredientes Principales</h3>
                        <p id="modalProductIngredients">Ingredientes no especificados</p>
                    </div>
                    
                    <div class="modal-section" id="modalUsageSection">
                        <h3>‚ö° Modo de Uso</h3>
                        <p id="modalProductUsage">Instrucciones no especificadas</p>
                    </div>
                    
                    <div class="modal-section">
                        <h3>üìä Especificaciones</h3>
                        <div class="specs-grid">
                            <div class="spec-item">
                                <span class="spec-label">SKU:</span>
                                <span id="modalProductSKU">N/A</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Stock:</span>
                                <span id="modalProductStock">0</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Peso/Cantidad:</span>
                                <span id="modalProductQuantity">N/A</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="add-to-cart-modal" id="modalAddToCart">
                            Agregar al Carrito
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script src="js/products.js"></script>
    
    <script>
    // ==================== MODAL DE PRODUCTO PARA PRODUCTS.HTML ====================
    console.log('üöÄ Cargando sistema de modal para products.html...');

    // Funci√≥n para abrir el modal de producto
    function openProductModal(productId) {
        console.log('üéØ Abriendo modal para producto ID:', productId);
        
        const product = window.productsData.find(p => p.id === productId);
        if (!product) {
            console.log('‚ùå Producto no encontrado');
            return;
        }
        
        console.log('üì¶ Producto encontrado:', product.name);
        
        // Llenar el modal con la informaci√≥n del producto
        document.getElementById('modalProductName').textContent = product.name;
        document.getElementById('modalProductPrice').textContent = formatCLP(product.price);
        document.getElementById('modalProductCategory').textContent = getCategoryName(product.category);
        document.getElementById('modalProductDescription').textContent = product.description;
        document.getElementById('modalProductSKU').textContent = product.sku || 'N/A';
        document.getElementById('modalProductStock').textContent = product.stock;
        document.getElementById('modalProductQuantity').textContent = product.quantity && product.unit ? 
            `${product.quantity} ${product.unit}` : 'N/A';
        
        // Imagen
        const productImage = document.getElementById('modalProductImage');
        const imagePlaceholder = document.getElementById('modalImagePlaceholder');
        
        if (product.image) {
            productImage.src = product.image;
            productImage.style.display = 'block';
            imagePlaceholder.style.display = 'none';
        } else {
            productImage.style.display = 'none';
            imagePlaceholder.style.display = 'flex';
        }
        
        // Ingredientes (ocultar si no hay)
        const ingredientsSection = document.getElementById('modalIngredientsSection');
        const ingredientsText = document.getElementById('modalProductIngredients');
        if (product.ingredients) {
            ingredientsText.textContent = product.ingredients;
            ingredientsSection.style.display = 'block';
        } else {
            ingredientsSection.style.display = 'none';
        }
        
        // Modo de uso (ocultar si no hay)
        const usageSection = document.getElementById('modalUsageSection');
        const usageText = document.getElementById('modalProductUsage');
        if (product.usage) {
            usageText.textContent = product.usage;
            usageSection.style.display = 'block';
        } else {
            usageSection.style.display = 'none';
        }
        
        // Configurar bot√≥n de agregar al carrito
        const addToCartBtn = document.getElementById('modalAddToCart');
        addToCartBtn.onclick = function(event) {
            event.stopPropagation();
            addToCart(product);
            closeProductModal();
            showNotification(`${product.name} agregado al carrito`);
        };
        
        // Mostrar modal
        const modal = document.getElementById('productModal');
        modal.classList.add('active');
        console.log('‚úÖ Modal activado');
        
        // Prevenir scroll del body
        document.body.style.overflow = 'hidden';
    }

    // Funci√≥n para cerrar el modal
    function closeProductModal() {
        const modal = document.getElementById('productModal');
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
        console.log('üîí Modal cerrado');
    }

    // Funci√≥n auxiliar para obtener nombre de categor√≠a
    function getCategoryName(categoryId) {
        if (!window.categories) {
            window.categories = JSON.parse(localStorage.getItem('hairia_categories')) || [];
        }
        const category = window.categories.find(cat => cat.id === categoryId);
        return category ? category.name : categoryId;
    }

    // Configurar event listeners cuando se cargue la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üîß Configurando modal para products.html...');
        
        const modalOverlay = document.getElementById('modalOverlay');
        const modalClose = document.getElementById('modalClose');
        
        if (modalOverlay) {
            modalOverlay.addEventListener('click', closeProductModal);
            console.log('‚úÖ Overlay configurado');
        }
        
        if (modalClose) {
            modalClose.addEventListener('click', closeProductModal);
            console.log('‚úÖ Bot√≥n cerrar configurado');
        }
        
        // Cerrar con ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeProductModal();
            }
        });
        
        console.log('üéâ Modal para products.html completamente configurado');
    });

    // Hacer funciones globales
    window.openProductModal = openProductModal;
    window.closeProductModal = closeProductModal;
    window.getCategoryName = getCategoryName;
    </script>
</body>
</html>